import torch

# Assume h has shape (batch_size, num_heads, hidden_dim)
h = torch.randn(32, 5, 64)

# Assume adjacency_matrix has shape (batch_size, num_nodes, num_nodes)
adjacency_matrix = torch.randint(2, (32, 10, 10))


# Concatenate h to calculate a_input
# We only want to expand h along the last dimension
a_input = torch.cat([h.unsqueeze(2).expand(-1, -1, 5, -1),
                     h.unsqueeze(1).expand(-1, 5, -1, -1)], dim=-1)

# Print the size of a_input
print(a_input.size())  # Output: torch.Size([32, 4, 4, 10, 128])
